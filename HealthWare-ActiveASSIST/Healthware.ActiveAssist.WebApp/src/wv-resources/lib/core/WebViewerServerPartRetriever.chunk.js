/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[15],{374:function(Da,xa,z){function na(w,aa,fa){aa.endsWith("/")||(aa+="/");fa=fa||{};var ja=fa.disableWebsockets||!1;this.eU=fa.singleServerMode||!1;null!=fa.customQueryParameters&&Object(h.b)("wvsQueryParameters",fa.customQueryParameters);aa.endsWith("blackbox/")||(aa+="blackbox/");this.an=fa.uploadData||null;this.nw=fa.uriData||null;this.$M=fa.cacheKey||null;this.hR=fa.officeLocale||null;this.rE=Object(n.a)(aa,null,ja);this.Sf=
aa;this.HE=w;this.qf=null;this.wj=ia();this.Xl=ia();this.vy=!1;this.dg=this.Pd=this.je=this.Ve=null;this.wf=[];this.ez=[];this.cache={};this.timeStamp=0;this.Nf=[];this.dh=[];this.cF=null;this.zE=!1;this.pI=this.id=null;this.XG=this.KP=ka;this.pB=0;this.cG=!1;this.a8=1;this.uA={};this.Vr(!0)}function ia(){var w={promise:null,resolve:null,reject:null,state:0,result:null,request:null,kr:function(){return 1===(w.state&1)},W6:function(){return 2===(w.state&2)},Uh:function(){return!w.W6()&&!w.kr()},C6:function(){return 4===
(w.state&4)},qT:function(){w.state|=4}};w.promise=new Promise(function(aa,fa){w.resolve=function(){if(0===w.state||4===w.state)w.state=1,w.result=arguments[0],aa.apply(null,arguments)};w.reject=function(){if(0===w.state||4===w.state)w.state=2,fa.apply(null,arguments)}});return w}function ka(){return!1}function ea(w,aa,fa){if(!(aa in e))return!0;aa=e[aa];for(var ja=0;ja<aa.length;ja++){var ba=w;var ha=aa[ja];var ca=fa;if(ha.name in ba){var la="",ua=!1;ba=ba[ha.name];switch(ha.type){case "s":la="String";
ua=Object(da.isString)(ba);break;case "a":la="Array";ua=Object(da.isArray)(ba);break;case "n":la="Number";ua=Object(da.isNumber)(ba)&&Object(da.isFinite)(ba);break;case "o":la="Object",ua=Object(da.isObject)(ba)&&!Object(da.isArray)(ba)}ua||ca.reject('Expected response field "'+ha.name+'" to have type '+la);ha=ua}else ca.reject('Response missing field "'+ha.name+'"'),ha=!1;if(!ha)return!1}return!0}z.r(xa);var da=z(0);z.n(da);var x=z(1);Da=z(46);var r=z(31),n=z(392),a=z(78),b=z(319),f=z(97),h=z(39),
y=z(140),e={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}]};na.prototype=Object(da.extend)(na.prototype,{K0:function(){var w=this;
return new Promise(function(aa,fa){var ja=new XMLHttpRequest;ja.open("GET",w.Sf+"ck");ja.withCredentials=w.Co();ja.onreadystatechange=function(){ja.readyState===XMLHttpRequest.DONE&&(200===ja.status?aa():fa())};ja.send()})},wba:function(w,aa){this.KP=w||ka;this.XG=aa||ka},oN:function(){var w=this;this.Xl=ia();this.wj=ia();return this.rE.TE().then(function(){w.vy=!1;w.id=null;w.zE=!1;return w.K0()})},dI:function(){this.KP();this.qG();this.Ve&&(this.Ve.Uh()?this.rf(this.Ve.request):this.Ve.kr()&&this.XG(this.Ve.result.url,
"pdf")&&(this.Ve=null,this.QS()));this.dg&&this.dg.Uh()&&this.rf(this.dg.request);this.je&&this.je.Uh()?this.rf(this.je.request):this.Pd&&this.Pd.Uh()&&this.zP(this.Pd.request);var w;for(w=0;w<this.Nf.length;w++)this.Nf[w]&&this.Nf[w]&&(this.Nf[w].Uh()?this.rf(this.Nf[w].request):this.Nf[w].kr()&&this.XG(this.Nf[w].result.url,"image")&&(this.Nf[w]=null,this.mB(w)));for(w=0;w<this.dh.length;w++)this.dh[w]&&this.dh[w]&&this.dh[w].Uh()&&!this.dh[w].C6()&&this.rf(this.dh[w].request);for(w=0;w<this.wf.length;w++)this.wf[w]&&
this.wf[w].Uh()&&this.rf(this.wf[w].request)},qG:function(w){var aa=this;this.vy||(this.timeStamp=Date.now(),this.rE.WI(function(fa){aa.p8(fa)},function(){return null},function(){return null},!0).then(function(){clearInterval(aa.dB);aa.dB=null},function(fa){aa.vy=!1;if(!aa.dB){var ja=0;aa.zE=!0;aa.pI=0;aa.dB=setInterval(function(){2>ja++?aa.dI():(clearInterval(aa.dB),w&&w.reject(f.a),Object(x.f)("WebViewerServer connection failed:"+fa))},5E3)}}),this.vy=!0)},Fda:function(){var w=this,aa=createPromiseCapability();
if(this.an){var fa=new FormData;fa.append("file",this.an.fileHandle,this.an.fileHandle.name);var ja=this.an.loadCallback;var ba="upload";var ha=this.an.extension}else if(this.nw){fa={uri:this.nw.uri,lha:this.nw.shareId};fa=Object.keys(fa).map(function(ma){return ma+"="+(fa[ma]?encodeURIComponent(fa[ma]):"")}).join("&");var ca="application/x-www-form-urlencoded; charset=UTF-8";ja=this.nw.loadCallback;ba="url";ha=this.nw.extension}else return Promise.resolve();var la=new XMLHttpRequest,ua=Object(r.i)(w.Sf,
"AuxUpload");ua=Object(y.a)(ua)+"&type="+ba+"&ext="+ha;la.open("POST",ua);la.withCredentials=this.Co();ca&&la.setRequestHeader("Content-Type",ca);la.addEventListener("load",function(){if(la.readyState===la.DONE&&200===la.status){var ma=JSON.parse(la.response);w.HE=ma.uri;ja(ma);aa.resolve(ma)}});la.addEventListener("error",function(){aa.reject(la.statusText+" "+JSON.stringify(la))});this.an&&null!=this.an.onProgress&&(la.upload.onprogress=function(ma){w.an.onProgress(ma)});la.send(fa);return aa.promise},
eaa:function(w){this.password=w||null;this.wj.kr()||(this.wj=ia(),this.rf({t:"pages"}));return this.wj.promise},Hv:function(w){this.cF=w||null;this.wj.kr()||(this.qG(this.wj),this.rf({t:"pages"}));return this.wj.promise},qN:function(w){w=Object.assign(w,{uri:encodeURIComponent(this.HE)});this.cF&&(w.ext=this.cF);this.qf&&(w.c=this.qf);this.password&&(w.pswd=this.password);this.$M&&(w.cacheKey=this.$M);this.hR&&(w.locale=this.hR);return w},rf:function(w){w=this.qN(w);this.rE.send(w)},mk:function(w){return w},
p8:function(w){var aa=this,fa=w.data,ja=w.err,ba=w.t;switch(ba){case "upload":ja?aa.Gda.reject(ja):aa.Gda.resolve("Success");break;case "pages":ja?aa.wj.reject(ja):ea(fa,ba,aa.wj)&&aa.wj.resolve(fa);break;case "config":ja?aa.Xl.reject(ja):ea(fa,ba,aa.Xl)&&(fa.id&&(aa.id=fa.id),fa.auth&&(w=Object(h.a)("wvsQueryParameters"),w.auth=fa.auth,Object(h.b)("wvsQueryParameters",w)),fa.serverVersion&&(aa.Zda=fa.serverVersion,Object(x.g)("[WebViewer Server] server version: "+aa.Zda)),fa.serverID?(aa.pB=fa.serverID===
aa.pI&&aa.cG?aa.pB+1:0,aa.pI=fa.serverID):aa.pB=0,aa.cG=!1,aa.Xl.resolve(fa));break;case "health":ja?aa.Xl.reject(ja):ea(fa,ba,aa.Xl)&&(fa=fa.unhealthy,aa.eU&&fa?Object(x.i)("Server failed health check. Single server mode ignoring check."):!aa.Jfa&&fa&&1>=aa.pB&&(aa.cG=!0,aa.oN().then(function(){aa.dI()},function(){aa.dI()})));break;case "pdf":fa.url=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url));ja?aa.Ve.reject(ja):ea(fa,ba,aa.Ve)&&aa.Ve.resolve(fa);break;case "docmod":fa.url=Object(y.a)(aa.Sf+"../"+
encodeURI(fa.url));ja?aa.uA[fa.rID].reject(ja):ea(fa,ba,aa.Ve)&&aa.uA[fa.rID].resolve(fa);break;case "xod":if(ja)this.je&&this.je.Uh()&&this.je.reject(ja),this.Pd&&this.Pd.Uh()&&this.Pd.reject(ja);else if(fa.notFound)fa.noCreate||this.je&&this.je.Uh()&&this.je.resolve(fa),this.Pd&&this.Pd.Uh()&&this.Pd.resolve(fa);else{fa.url&&(fa.url=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url)));if(!this.Pd||this.Pd.kr())this.Pd=ia(),this.Pd.request={t:"xod",noCreate:!0};this.je||(this.je=ia(),this.je.request={t:"xod"});
this.Pd.resolve(fa);this.je.resolve(fa)}break;case "annots":if(ja)aa.dg.reject(ja);else if(ea(fa,ba,aa.dg)){aa.dg.qT();var ha=new XMLHttpRequest;w=aa.Sf+"../"+encodeURI(fa.url);var ca=fa.hasAppearance?Object(y.a)(w+".xodapp"):null;ha.open("GET",Object(y.a)(w));ha.responseType="text";ha.withCredentials=this.Co();ha.addEventListener("load",function(){ha.readyState===ha.DONE&&200===ha.status&&aa.dg.resolve({sJ:ha.response,LM:ca})});ha.addEventListener("error",function(){aa.dg.reject(ha.statusText+" "+
JSON.stringify(ha))});ha.send()}break;case "image":var la=this.Nf[fa.p];ja?la.promise.reject(ja):ea(fa,ba,la)&&(la.result=fa,la.result.url=Object(y.a)(aa.Sf+"../"+encodeURI(la.result.url)),la.resolve(la.result));break;case "tiles":la=fa.rID;w=this.wf[la];this.wf[la]=null;this.ez.push(la);if(ja)w.reject(ja);else if(ea(fa,ba,w)){for(ja=0;ja<fa.tiles.length;ja++)fa.tiles[ja]=Object(y.a)(aa.Sf+"../"+encodeURI(fa.tiles[ja]));w.resolve(fa)}break;case "text":la=this.dh[fa.p];if(ja)la.reject(ja);else if(ea(fa,
ba,la)){la.qT();var ua=new XMLHttpRequest;fa=Object(y.a)(aa.Sf+"../"+encodeURI(fa.url));ua.open("GET",fa);ua.withCredentials=this.Co();ua.addEventListener("load",function(){ua.readyState===ua.DONE&&200===ua.status&&(la.result=JSON.parse(ua.response),la.resolve(la.result))});ua.addEventListener("error",function(ma){la.reject(ua.statusText+" "+JSON.stringify(ma))});ua.send()}break;case "progress":"loading"===fa.t&&aa.trigger(a.a.Events.DOCUMENT_LOADING_PROGRESS,[fa.bytes,fa.total])}},LO:function(){this.qG(this.Xl);
return this.Xl.promise},N3:function(){this.dg||(this.dg=ia(),this.dg.request={t:"annots"},this.rf(this.dg.request));return this.dg.promise},mB:function(w){this.Nf[w]||(this.Nf[w]=ia(),this.Nf[w].request={t:"image",p:w},this.rf(this.Nf[w].request));return this.Nf[w].promise},faa:function(w){this.dh[w]||(this.dh[w]=ia(),this.dh[w].request={t:"text",p:w},this.rf(this.dh[w].request));return this.dh[w].promise},gaa:function(w,aa,fa,ja){var ba=this.wf.length;this.ez.length&&(ba=this.ez.pop());this.wf[ba]=
ia();this.wf[ba].request={t:"tiles",p:w,z:aa,r:fa,size:ja,rID:ba};this.rf(this.wf[ba].request);return this.wf[ba].promise},QS:function(){this.Ve||(this.Ve=ia(),this.Ve.request={t:"pdf"},this.zE?this.Ve.resolve({url:this.HE}):this.rf(this.Ve.request));return this.Ve.promise},bP:function(w){var aa=this,fa=new XMLHttpRequest,ja=Object(y.a)(this.Sf+"aul")+"&id="+this.id,ba=new FormData,ha={};w.annots&&(ha.annots="xfdf");w.watermark&&(ha.watermark="png");w.redactions&&(ha.redactions="redact");ha={t:"docmod",
reqID:this.a8++,parts:ha};w.print&&(ha.print=!0);var ca=this.qN(ha);ba.append("msg",JSON.stringify(ca));return Promise.all([w.annots,w.watermark,w.redactions].map(function(la){return Promise.resolve(la)})).then(function(la){var ua=la[0],ma=la[1],sa=la[2];ua&&ba.append("annots",ua);ma&&ba.append("watermark",la.watermark);sa&&ba.append("redactions",sa);aa.uA[ca.reqID]=ia();fa.open("POST",ja);fa.withCredentials=aa.Co;la=new Promise(function(oa,ra){fa.onreadystatechange=function(){4===fa.readyState&&
(200===fa.status?oa():ra("An error occurred while sending down annotation data to the server"))}});fa.send(ba);return la.then(function(){return aa.uA[ca.reqID].promise})})},zP:function(){this.Pd||(this.Pd=ia(),this.Pd.request={t:"xod",noCreate:!0},this.rf(this.Pd.request));return this.Pd.promise},haa:function(){this.je||(this.je=ia(),this.je.request={t:"xod"},this.rf(this.je.request));return this.je.promise},Mm:function(){return!0},request:function(){},lS:function(){},abort:function(){for(var w=0;w<
this.wf.length;w++)this.wf[w]&&(this.wf[w].resolve(null),this.wf[w]=null,this.ez.push(w));this.close()},wB:function(w){this.qf=this.qf||{};this.qf.headers=w},aga:function(){return this.qf?Object(da.omit)(this.qf.headers,["Cookie","cookie"]):null},Vr:function(w){this.qf=this.qf||{};this.qf.internal=this.qf.internal||{};this.qf.internal.withCredentials=w},Co:function(){return this.qf&&this.qf.internal?this.qf.internal.withCredentials:null},getFileData:function(){return Promise.reject()}});Object(Da.a)(na);
Object(b.a)(na);Object(b.b)(na);xa["default"]=na},392:function(Da,xa,z){function na(x,r,n){function a(f,h){function y(sa){w().then(function(oa){ca&&!la?setTimeout(function(){y(sa)},1):oa.send(JSON.stringify(sa))})}function e(sa,oa,ra,ta){var qa=window.createPromiseCapability(),wa=!1,Aa=qa;ja=sa;ba=oa;ha=ra;fa=null;ta&&(sa=Object(ea.a)("wvsQueryParameters"),sa.bcid=Object(ka.j)(8),Object(ea.b)("wvsQueryParameters",sa));try{sa=ua?ma+"/"+ua:ma+"/ws";sa=Object(da.a)(sa);var Ga=new WebSocket(sa);Ga.onopen=
function(){qa.resolve();wa=!0;qa=null;ca=!1;aa.resolve(Ga);ba&&ba()};Ga.onerror=function(Na){ca=la=!0;qa&&qa.reject(Na);fa&&fa.reject()};Ga.onclose=function(){aa=window.createPromiseCapability();ca=!0;fa||(fa=window.createPromiseCapability());fa.resolve();ha&&ha();ja&&wa&&ja({t:"health",data:{unhealthy:!0,isDead:!0}})};Ga.onmessage=function(Na){Na&&Na.data&&(Na=JSON.parse(Na.data),Na.hb?y({hb:!0}):Na.end?close():ja(Na))}}catch(Na){qa.reject(Na),qa=null}return Aa.promise}function w(){ca&&ja&&e(ja);
return aa.promise}var aa=window.createPromiseCapability(),fa=null,ja,ba,ha=null,ca=!1,la=!1,ua=h,ma=function(sa){var oa=sa.indexOf("://"),ra="ws://";0>oa?oa=0:(5===oa&&(ra="wss://"),oa+=3);var ta=sa.lastIndexOf("/");0>ta&&(ta=sa.length);return ra+sa.slice(oa,ta)}(f);return{send:y,WI:e,TE:function(){return fa?fa.promise:w().then(function(sa){fa=window.createPromiseCapability();ja=null;sa.close();return fa.promise})}}}function b(f){var h=f.lastIndexOf("/");0>h&&(h=f.length);return f.slice(0,h)}return window.WebSocket&&
!n?a(x,r):function(f,h){function y(sa){(ha?ha.promise:Promise.resolve(ba)).then(function(oa){var ra=new XMLHttpRequest,ta=ja?fa+"/"+ja+"pf":fa+"/pf";ta=Object(da.a)(ta)+"&id="+oa;oa=new FormData;oa.append("data",JSON.stringify(sa));ra.open("POST",ta);ra.withCredentials=!0;ra.send(oa)})}function e(){ba=0;ha||(ha=window.createPromiseCapability())}function w(){aa=new XMLHttpRequest;var sa=fa+"/pf";sa+=0!==ba?"?id="+ba+"&uc="+ma:"?uc="+ma;ma++;aa.open("GET",sa,!0);aa.withCredentials=!0;aa.setRequestHeader("Cache-Control",
"no-cache");aa.setRequestHeader("X-Requested-With","XMLHttpRequest");var oa=aa,ra=!1;aa.onreadystatechange=function(){a:if(3<=oa.readyState&&!ra){try{var ta=oa.responseText.length}catch(Aa){Object(ia.g)("caught exception");break a}if(0<ta)try{var qa=oa.responseText.split("\n");for(qa[qa.length-1]&&qa.pop();0<qa.length&&3>qa[qa.length-1].length;)"]"===qa.pop()&&e();0<qa.length&&3>qa[0].length&&qa.shift();for(ta=0;ta<qa.length;++ta)qa[ta].endsWith(",")&&(qa[ta]=qa[ta].substr(0,qa[ta].length-1));0===
ba&&0<qa.length&&(ba=JSON.parse(qa.shift()).id,ta=ha,ha=null,ta.resolve(ba));var wa;for(ta=0;ta<qa.length;++ta)(wa=JSON.parse(qa[ta]))&&wa.end?close():wa&&wa.hb&&wa.id===ba?y({hb:!0}):ua(wa)}catch(Aa){}ca||(ra=!0,w())}};aa.send()}var aa,fa=b(f),ja=h,ba=0,ha=window.createPromiseCapability(),ca=!1,la=null,ua=null,ma=0;return{send:y,WI:function(sa,oa,ra){ua=sa;la=ra;ca=!1;e();w();oa&&oa();return Promise.resolve()},TE:function(){e();ua=null;ca=!0;la&&la();aa.abort();return Promise.resolve()}}}(x,r)}z.d(xa,
"a",function(){return na});var ia=z(1),ka=z(31),ea=z(39),da=z(140)}}]);}).call(this || window)
